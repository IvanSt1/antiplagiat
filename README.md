
# Платформа для проверки на антиплагиат решений заданий

## Описание

Этот проект использует Selenium и AST для анализа Python решений студентов и проверки их на схожесть (антиплагиат). Скрипты скачивают решения студентов, сравнивают их структуры, а затем сохраняют отчеты в формате CSV и XLSX. Для каждого задания создается отдельный файл с результатами сравнения между студентами.

## Что необходимо установить

Для работы с этим проектом нужно установить несколько библиотек:

1. **selenium** — для работы с браузером через Selenium.
2. **beautifulsoup4** — для парсинга HTML.
3. **openpyxl** — для работы с файлами Excel.
4. **difflib** — для сравнения строк на основе их структуры.

Чтобы установить все необходимые библиотеки, выполните следующую команду:

```bash
pip install selenium beautifulsoup4 openpyxl
```

## Где указывать ID задания, список классов и путь до драйвера

1. **ID задания**:  
   Для задания укажите его ID в переменной `quiz_id` в скрипте `main_selenium.py`. Например:

   ```python
   quiz_id = "2732"  # Задайте ID задания
   ```
   Id можно увидеть в когда открываем результат в url как в примере:
   https://sdo24.1580.ru/mod/quiz/view.php?id=2475

3. **Классы для проверки**:  
   Классы для проверки указываются в списке `classes_to_check` в скрипте `main_selenium.py`. Например:

   ```python
   classes_to_check = ["10Е1", "10Е2", "10З1", "10З2"]  # Укажите нужные классы
   ```

4. **Путь до драйвера**:  
   Укажите путь к файлу `chromedriver.exe` в переменной `path_to_driver` в скрипте `main_selenium.py`. Например:

   ```python
   path_to_driver = r"C:path/to/chromedriver.exe"  # Укажите путь к chromedriver.exe
   ```

5. **Файл с данными о классах**:  
   В файле `class_data.json` должен быть список классов и учеников. Этот файл загружается в функцию `load_class_data`. Формат файла:

   ```json
   {
     "school": {
       "classes": [
         {
           "class_id": "10Е1",
           "students": [
             "Имя Фамилия",
             "Имя Фамилия",
             "Имя Фамилия"
           ]
         },
         {
           "class_id": "10Е2",
           "students": [
             "Имя Фамилия",
             "Имя Фамилия"
           ]
         }
       ]
     }
   }
   ```

## Как работает

1. **Скачивание решений**:  
   Скрипт `main_selenium.py` загружает решения студентов из системы Moodle. В нем производится вход в систему через браузер, а затем для каждого ученика скачиваются их решения заданий.
   
2. **Проверка на антиплагиат**:  
   Скрипт `main_antiplagiat.py` сравнивает загруженные решения между собой, игнорируя имена переменных и их порядок, используя структуру абстрактного синтаксического дерева (AST). Он вычисляет схожесть решений в процентах и сохраняет результат в таблицах.

3. **Результаты**:  
   Результаты сравнения выводятся в CSV и Excel файлы, которые содержат таблицы с процентами схожести между студентами для каждого задания. Ячейки с процентом схожести 100% выделяются красным цветом в Excel.

4. **Список учеников с полным совпадением**:  
   Список учеников, у которых хотя бы одно совпадение 100%, сохраняется в текстовый файл `students_with_100.txt`.

## Как использовать

1. **Запустите Selenium скрипт** для загрузки решений студентов:

   ```bash
   python main_selenium.py
   ```

   Этот скрипт загрузит все решения для заданного теста и сохранит их в соответствующие директории для каждого ученика.

2. **Запустите скрипт проверки на антиплагиат**:

   ```bash
   python main_antiplagiat.py
   ```

   Скрипт сравнит все решения между собой и создаст отчеты в папке `plagiarism_reports`, а также файл с учениками, имеющими хотя бы одно совпадение 100%.

## Выходные файлы

1. **CSV**: Отчеты о схожести для каждого задания сохраняются в CSV файлы.
2. **XLSX**: Для каждого задания также создается Excel файл с форматированием ячеек, в которых найдено совпадение 100%.
3. **students_with_100.txt**: Список студентов, у которых есть хотя бы одно совпадение 100%.


